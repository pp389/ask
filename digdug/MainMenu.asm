PROC MENU_INPUT
	PUSH AX
	PUSH BX
	
	MOV AH, 1
	INT 16H
	
	JNZ @@NEWDATA 	
	JMP	@@END_PROC	

	@@NEWDATA:
	MOV AH, 0
	INT 16H

	CMP AH, ARR_U
	JZ  @@UP
	
	CMP AH, ARR_D
	JZ  @@DOWN
	
	CMP AH, SC_SPACE
	JZ  @@CLICK
	
	CMP AH, SC_ENTER
	JZ  @@CLICK
	JMP @@END_PROC

@@CLICK: 
	CALL MENU_CLICK
	JMP  @@END_PROC

@@UP: 
	DEC [MENU_PTR]
	JMP @@OVERFLOW

@@DOWN:
	INC [MENU_PTR]

@@OVERFLOW: ;{
	CMP [MENU_PTR], 3
	JZ  @@MIN_PTR

	JNZ @@COLOR

@@MAX_PTR: ;{
	MOV [MENU_PTR], 2
	JMP @@COLOR

@@MIN_PTR: ;{
	MOV [MENU_PTR], 0


@@COLOR: 
	MOV BX, OFFSET MENU_TXT_COL
	MOV [WORD PTR BX] , WHITE
	MOV [WORD PTR BX + 2], WHITE
	MOV [WORD PTR BX + 4], WHITE

	MOV BL, [MENU_PTR]
	XOR BH, BH
	SHL BX, 1
	ADD BX, OFFSET MENU_TXT_COL
	MOV [WORD PTR BX], RED 

@@END_PROC:
	XOR AL, AL
	MOV AH, 0CH
	INT 21H

	POP BX
	POP AX
	RET
ENDP MENU_INPUT


PROC MENU_PRINT_TEXT
	PUSH AX
	PUSH BX
	PUSH SI
	PUSH DI

	MOV AX, 15
	
	MOV SI, OFFSET MENU_TXT_OFF
	MOV DI, OFFSET MENU_TXT_COL
	XOR BX, BX
				
@@TEXT_LOOP:

	PUSH 18
	PUSH AX
	CALL TEXT_SET_CURPOS
	
	PUSH [DI + BX]
	PUSH [SI + BX]
	CALL TEXT_COLORSTR
	
	ADD AX, 2
	ADD BX, 2
	CMP BX, 6
	JNZ @@TEXT_LOOP

	
@@END_PROC: 
	POP DI
	POP SI
	POP BX
	POP AX
	
	RET

ENDP MENU_PRINT_TEXT


PROC MENU_CLICK

	CMP [MENU_PTR], BTN_PLAY
	JZ  @@PLAY
	
	CMP [MENU_PTR], BTN_HELP
	JZ  @@HELP
	JMP EXIT
	
@@PLAY: 
	CALL NEW_GAME


@@HELP: 
	PUSH 14
	PUSH 9
	CALL TEXT_SET_CURPOS
	
	PUSH OFFSET STR_INST_1
	CALL TEXT_PRINT_MSG

	PUSH 14
	PUSH 10
	CALL TEXT_SET_CURPOS
	
	PUSH OFFSET STR_INST_2
	CALL TEXT_PRINT_MSG
	

	MOV AH, 7
	INT 21H
		
	PUSH 112
	PUSH 72
	PUSH 104
	PUSH 24
	PUSH BLACK
	CALL GRAPHICS_PRINTRECT


@@END_PROC:	
	RET
ENDP MENU_CLICK


PROC MAINMENU
	MOV BX, OFFSET MENU_TXT_OFF
	MOV [WORD PTR BX]    , OFFSET STR_PLAY
	MOV [WORD PTR BX + 2], OFFSET STR_HELP
	MOV [WORD PTR BX + 4], OFFSET STR_EXIT
	
	MOV BX, OFFSET MENU_TXT_COL
	MOV [WORD PTR BX]    , RED
	MOV [WORD PTR BX + 2], WHITE
	MOV [WORD PTR BX + 4], WHITE

	PUSH 0
	PUSH 0
	PUSH 320
	PUSH 200
	PUSH BROWN
	CALL GRAPHICS_PRINTRECT


@@MAINMENU: 
	CALL MENU_INPUT
	CALL MENU_PRINT_TEXT
	JMP  @@MAINMENU

	RET
ENDP MAINMENU

